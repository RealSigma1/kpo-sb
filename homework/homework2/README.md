# ВШЭ-Банк — Модуль учета финансов
**Домашнее задание №2 — Паттерны проектирования**

Приложение реализует «Учет финансов».  
Оно позволяет:

- создавать, редактировать и удалять **счета**, **категории** и **операции** (доходы/расходы);
- выполнять **аналитику** доходов и расходов;
- **экспортировать** и **импортировать** данные в форматы CSV, JSON, YAML;
- **пересчитывать баланс** счёта при несоответствии;
- **измерять время** выполнения сценариев с помощью паттернов *Команда* и *Декоратор*.

Все действия демонстрируются автоматически при запуске программы в классе `Main`.
---

## Основная функциональность

| Сущность | Методы | Расположение |
|-----------|---------|--------------|
| **BankAccount** | создание, обновление, удаление | `BankAccountService` |
| **Category** | создание, обновление, удаление | `CategoryService` |
| **Operation** | создание, обновление, удаление | `OperationService` |
| **Analytics** | разница доходов/расходов, группировка по категориям | `AnalyticsService` |
| **Импорт/экспорт** | CSV, JSON, YAML | `DataExportService`, `JsonDataImporter` |
| **Пересчет баланса** | ручной пересчет при несоответствии | `BankAccountService.recalculateBalance()` |
| **Измерение времени** | измерение времени выполнения команд | `CommandTimerDecorator` |

---

## Использованные паттерны GoF

| Паттерн | Класс(ы) | Назначение |
|----------|-----------|-------------|
| **Фасад (Facade)** | `BankAccountService`, `CategoryService`, `OperationService`, `AnalyticsService`, `DataExportService` | Скрывают сложность взаимодействия с репозиториями, предоставляют единый интерфейс для работы с доменной моделью |
| **Команда (Command)** | `ICommand`, `CreateAccountCommand`, `CreateOperationCommand` | Инкапсулируют выполнение сценариев (создание счетов/операций) как отдельных команд |
| **Декоратор (Decorator)** | `CommandTimerDecorator` | Добавляет измерение времени выполнения команд без изменения их кода |
| **Фабрика (Factory)** | `FinancialFactory` | Создает валидные объекты доменной модели (`BankAccount`, `Category`, `Operation`) и гарантирует корректность данных |
| **Шаблонный метод (Template Method)** | `DataImporter`, `JsonDataImporter`, `CsvDataImporter` | Определяет общий алгоритм импорта данных с переопределением шага парсинга для конкретных форматов |
| **Посетитель (Visitor)** | `IExportVisitor`, `CsvExportVisitor`, `JsonExportVisitor`, `YamlExportVisitor` | Реализует экспорт данных в разные форматы без изменения классов модели |
| **Прокси (Proxy)** | `RepositoryProxy`, `BankAccountRepositoryProxy`, `CategoryRepositoryProxy`, `OperationRepositoryProxy` | Добавляет слой кэширования и контроля над доступом к данным |
| **Стратегия (Strategy)** | `IAnalyticsStrategy`, `BalanceAnalytics`, `CategoryAnalytics` | Позволяет гибко подменять логику аналитики (по балансу, по категориям и т.д.) |

---

## Принципы SOLID

| Принцип | Пример реализации |
|----------|------------------|
| **S — Single Responsibility** | Каждый сервис (`BankAccountService`, `CategoryService`, ...) отвечает только за один аспект логики |
| **O — Open/Closed** | Новые форматы импорта/аналитики добавляются без изменения существующих классов (Template Method / Strategy) |
| **L — Liskov Substitution** | Репозитории и прокси реализуют общие интерфейсы `IRepository`, `IBankAccountRepository` и могут взаимозаменяться |
| **I — Interface Segregation** | Для каждой сущности свой интерфейс репозитория |
| **D — Dependency Inversion** | Сервисы зависят от интерфейсов, а не конкретных реализаций репозиториев |

---

## Принципы GRASP

| Принцип | Где реализован | Описание |
|----------|----------------|-----------|
| **High Cohesion** | Внутри сервисов и репозиториев | Каждый класс выполняет только свои задачи, логика не размазана |
| **Low Coupling** | Между сервисами и репозиториями | Связь идёт только через интерфейсы |
| **Controller** | Сервисы (`BankAccountService`, `OperationService`, ...) | Принимают запросы и управляют логикой |
| **Creator** | `FinancialFactory` | Создаёт объекты нужных типов с валидацией |

---

## Выполнение программы
При запуске выполняются сценарии:

1. Создание счетов (Command + Decorator)
2. Обновление и удаление счетов (CRUD)
3. Создание категорий
4. Обновление и удаление категорий (CRUD)
5. Создание, обновление и удаление операций (CRUD)
6. Аналитика (Strategy)
7. Отмена операции (Command.undo)
8. Проверка и пересчёт баланса (GRASP)
9. Экспорт данных (Visitor)
10. Импорт данных (Template Method)
11. Вывод итогового состояния

